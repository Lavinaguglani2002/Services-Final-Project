{"ast":null,"code":"import{useState,useEffect}from\"react\";import{useNavigate,useParams}from\"react-router-dom\";import axios from\"axios\";import{Link}from\"react-router-dom\";import\"./viewsubcategory.css\";import api from\"../axios\";import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";const Viewsmallsubcategory=()=>{const navigate=useNavigate();const{categoryname,subcategoryname}=useParams();const[smallsubcategories,setSmallSubcategories]=useState([]);const[cart,setCart]=useState([]);const[cartcount,setcartcount]=useState(0);// Initialize cartcount state\nconst email=localStorage.getItem(\"EMAIL\")||\"guest\";useEffect(()=>{// Fetch small subcategories\nconst fetchData=async()=>{try{const response=await api.get(`/getsubsmallcategory/${categoryname}/${subcategoryname}`);setSmallSubcategories(response.data);}catch(error){console.error(\"Error fetching data:\",error);}};fetchData();// Load cart for this user\nconst storedCart=JSON.parse(localStorage.getItem(`cart_${email}`))||[];//particular user ka data nikana\nsetCart(storedCart);setcartcount(storedCart.length);},[categoryname,subcategoryname,email]);const handleAddToCart=item=>{const existingItemIndex=cart.findIndex(cartItem=>cartItem.productId===item._id&&cartItem.status===\"pending\");let updatedCart;if(existingItemIndex!==-1){updatedCart=cart.map((cartItem,index)=>index===existingItemIndex?{...cartItem,//pehle waale item ki saari properties copy kar lo (spread operator)\nquantity:cartItem.quantity+1,price:(cartItem.quantity+1)*item.price}:cartItem//agar nahi (false), to purana item waise ka waise hi le lo\n);}else{updatedCart=[...cart,{productId:item._id,userId:email,name:item.smallsubcategoryname,image:item.smallsubcategoryimage,price:item.price,quantity:1,status:\"pending\"}];}setCart(updatedCart);setcartcount(updatedCart.length);// Save to localStorage using email\nlocalStorage.setItem(`cart_${email}`,JSON.stringify(updatedCart));localStorage.setItem(\"cartcount\",updatedCart.length);window.dispatchEvent(new Event(\"storage\"));alert(\"Item added to cart!\");navigate(\"/addtocart\");};return/*#__PURE__*/_jsxs(\"div\",{className:\"view-subcategory-wrapper container mt-4\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-center mb-4\",children:[subcategoryname,\" Products\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:smallsubcategories.map(item=>/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4 mb-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"img\",{src:item.smallsubcategoryimage,className:\"card-img-top\",alt:item.smallsubcategoryname}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsx(\"h5\",{children:item.smallsubcategoryname}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Price: \\u20B9\",item.price]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary w-100\",onClick:()=>handleAddToCart(item),children:\"Add to Cart\"})]})]})},item._id))})]});};export default Viewsmallsubcategory;","map":{"version":3,"names":["useState","useEffect","useNavigate","useParams","axios","Link","api","jsxs","_jsxs","jsx","_jsx","Viewsmallsubcategory","navigate","categoryname","subcategoryname","smallsubcategories","setSmallSubcategories","cart","setCart","cartcount","setcartcount","email","localStorage","getItem","fetchData","response","get","data","error","console","storedCart","JSON","parse","length","handleAddToCart","item","existingItemIndex","findIndex","cartItem","productId","_id","status","updatedCart","map","index","quantity","price","userId","name","smallsubcategoryname","image","smallsubcategoryimage","setItem","stringify","window","dispatchEvent","Event","alert","className","children","src","alt","onClick"],"sources":["C:/Users/Allied/Desktop/Serviceproject/client/src/Admin/Viewsmallsubcategory.js"],"sourcesContent":["\r\nimport { useState, useEffect } from \"react\";\r\nimport { useNavigate, useParams } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport { Link } from \"react-router-dom\";\r\nimport \"./viewsubcategory.css\"\r\nimport api from \"../axios\";\r\n\r\nconst Viewsmallsubcategory = () => {\r\n  const navigate = useNavigate();\r\n  const { categoryname, subcategoryname } = useParams();\r\n  const [smallsubcategories, setSmallSubcategories] = useState([]);\r\n  const [cart, setCart] = useState([]);\r\n  const [cartcount, setcartcount] = useState(0); // Initialize cartcount state\r\n  const email = localStorage.getItem(\"EMAIL\") || \"guest\";  \r\n  useEffect(() => {\r\n    // Fetch small subcategories\r\n    const fetchData = async () => {\r\n      try {\r\n        const response = await api.get(`/getsubsmallcategory/${categoryname}/${subcategoryname}`);\r\n        setSmallSubcategories(response.data);\r\n      } catch (error) {\r\n        console.error(\"Error fetching data:\", error);\r\n      }\r\n    };\r\n    fetchData();\r\n  \r\n    // Load cart for this user\r\n    const storedCart = JSON.parse(localStorage.getItem(`cart_${email}`)) || [];//particular user ka data nikana\r\n    setCart(storedCart);\r\n    setcartcount(storedCart.length);\r\n  }, [categoryname, subcategoryname, email]);\r\n  \r\n  const handleAddToCart = (item) => {\r\n    const existingItemIndex = cart.findIndex(\r\n      (cartItem) => cartItem.productId === item._id && cartItem.status === \"pending\"\r\n    );\r\n  \r\n    let updatedCart;\r\n    if (existingItemIndex !== -1) {\r\n      updatedCart = cart.map((cartItem, index) =>\r\n        index === existingItemIndex\r\n          ? {\r\n              ...cartItem,   //pehle waale item ki saari properties copy kar lo (spread operator)\r\n              quantity: cartItem.quantity + 1,\r\n              price: (cartItem.quantity + 1) * item.price,\r\n            }\r\n          : cartItem   //agar nahi (false), to purana item waise ka waise hi le lo\r\n  \r\n      );\r\n    } else {\r\n      updatedCart = [\r\n        ...cart,\r\n        {\r\n          productId: item._id,\r\n          userId: email,\r\n          name: item.smallsubcategoryname,\r\n          image: item.smallsubcategoryimage,\r\n          price: item.price,\r\n          quantity: 1,\r\n          status: \"pending\",\r\n        },\r\n      ];\r\n    }\r\n  \r\n    setCart(updatedCart);\r\n    setcartcount(updatedCart.length);\r\n  \r\n    // Save to localStorage using email\r\n    localStorage.setItem(`cart_${email}`, JSON.stringify(updatedCart));\r\n    localStorage.setItem(\"cartcount\", updatedCart.length);\r\n    window.dispatchEvent(new Event(\"storage\"));\r\n  \r\n    alert(\"Item added to cart!\");\r\n    navigate(\"/addtocart\");\r\n    \r\n  };\r\n  \r\n  \r\n\r\n  return (\r\n\r\n<div className=\"view-subcategory-wrapper container mt-4\">\r\n  <h2 className=\"text-center mb-4\">{subcategoryname} Products</h2>\r\n  <div className=\"row\">\r\n    {smallsubcategories.map((item) => (\r\n      <div className=\"col-md-4 mb-4\" key={item._id}>\r\n        <div className=\"card\">\r\n          <img\r\n            src={item.smallsubcategoryimage}\r\n            className=\"card-img-top\"\r\n            alt={item.smallsubcategoryname}\r\n          />\r\n          <div className=\"card-body\">\r\n            <h5>{item.smallsubcategoryname}</h5>\r\n            <p>Price: â‚¹{item.price}</p>\r\n            <button\r\n              className=\"btn btn-primary w-100\"\r\n              onClick={() => handleAddToCart(item)}\r\n            >\r\n              Add to Cart\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    ))}\r\n  </div>\r\n</div>\r\n\r\n  );\r\n};\r\n\r\nexport default Viewsmallsubcategory;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}