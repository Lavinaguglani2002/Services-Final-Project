{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{useNavigate}from\"react-router-dom\";import api from\"../axios\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Enquiries=()=>{const[items,setItems]=useState([]);const navigate=useNavigate();const defaultphoto=\"https://png.pngtree.com/png-vector/20231019/ourmid/pngtree-user-profile-avatar-png-image_10211467.png\";// ✅ Fetch Data Function\nconst fetchData=async()=>{try{const response=await api.get(\"/getallprofiles\");console.log(\"Enquiries Data:\",response.data);setItems(response.data);}catch(error){console.error(\"Error fetching data:\",error);}};useEffect(()=>{fetchData();},[]);const handleDelete=async id=>{if(!window.confirm(\"Are you sure you want to delete this profile?\"))return;try{await api.delete(`/delete/${id}`);alert(\"Profile deleted successfully\");const loggedEmail=localStorage.getItem(\"EMAIL\");const userToDelete=items.find(item=>item._id===id);// Deleted user ka email lena\nif(loggedEmail===(userToDelete===null||userToDelete===void 0?void 0:userToDelete.email)){localStorage.removeItem(\"EMAIL\");navigate(\"/login\");}fetchData();}catch(error){var _error$response,_error$response$data,_error$response2,_error$response2$data;console.error(\"❌ Error deleting profile:\",(_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message);alert(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||\"Failed to delete profile.\");}};const handleLogout=()=>{localStorage.clear();// ✅ Token Clear\nnavigate(\"/login\");};return/*#__PURE__*/_jsxs(\"div\",{className:\"container my-5\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-center mb-4\",children:\"User Enquiries\"}),/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table table-bordered table-striped text-center\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"table-dark\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Image\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Action\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:items.map(item=>{var _item$user;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"img\",{src:item.pic||defaultphoto,alt:\"Profile\",className:\"rounded-circle\",width:\"50\",height:\"50\"})}),/*#__PURE__*/_jsx(\"td\",{children:item.email}),/*#__PURE__*/_jsx(\"td\",{children:((_item$user=item.user)===null||_item$user===void 0?void 0:_item$user.name)||\"No Name\"}),\" \",/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger btn-sm\",onClick:()=>handleDelete(item._id),children:\"Delete\"})})]},item._id);})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"text-center mt-4\",children:/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,className:\"btn btn-success mx-2\",children:\"Add User\"})})]});};export default Enquiries;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","api","jsx","_jsx","jsxs","_jsxs","Enquiries","items","setItems","navigate","defaultphoto","fetchData","response","get","console","log","data","error","handleDelete","id","window","confirm","delete","alert","loggedEmail","localStorage","getItem","userToDelete","find","item","_id","email","removeItem","_error$response","_error$response$data","_error$response2","_error$response2$data","message","handleLogout","clear","className","children","map","_item$user","src","pic","alt","width","height","user","name","onClick"],"sources":["C:/Users/Allied/Desktop/Serviceproject/client/src/Admin/Enquiries.js"],"sourcesContent":["\r\n\r\n\r\n\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport api from \"../axios\";\r\n\r\nconst Enquiries = () => {\r\n  const [items, setItems] = useState([]);\r\n  const navigate = useNavigate();\r\n  const defaultphoto =\r\n    \"https://png.pngtree.com/png-vector/20231019/ourmid/pngtree-user-profile-avatar-png-image_10211467.png\";\r\n\r\n  // ✅ Fetch Data Function\r\n  const fetchData = async () => {\r\n    try {\r\n      const response = await api.get(\"/getallprofiles\");\r\n      console.log(\"Enquiries Data:\", response.data);\r\n      setItems(response.data);\r\n    } catch (error) {\r\n      console.error(\"Error fetching data:\", error);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n  }, []);\r\n\r\n  const handleDelete = async (id) => {\r\n    if (!window.confirm(\"Are you sure you want to delete this profile?\")) return;\r\n\r\n    try {\r\n      await api.delete(`/delete/${id}`);\r\n      alert(\"Profile deleted successfully\");\r\n\r\n      const loggedEmail = localStorage.getItem(\"EMAIL\");\r\n      const userToDelete = items.find((item) => item._id === id); // Deleted user ka email lena\r\n\r\n      if (loggedEmail === userToDelete?.email) {\r\n        localStorage.removeItem(\"EMAIL\");\r\n        navigate(\"/login\");\r\n      }\r\n\r\n      fetchData();\r\n    } catch (error) {\r\n      console.error(\"❌ Error deleting profile:\", error.response?.data?.message);\r\n      alert(error.response?.data?.message || \"Failed to delete profile.\");\r\n    }\r\n  };\r\n\r\n  const handleLogout = () => {\r\n    localStorage.clear(); // ✅ Token Clear\r\n    navigate(\"/login\");\r\n  };\r\n\r\n  return (\r\n    <div className=\"container my-5\">\r\n      <h2 className=\"text-center mb-4\">User Enquiries</h2>\r\n\r\n      <div className=\"table-responsive\">\r\n        <table className=\"table table-bordered table-striped text-center\">\r\n          <thead className=\"table-dark\">\r\n            <tr>\r\n              <th>Image</th>\r\n              <th>Email</th>\r\n              <th>Name</th>\r\n              <th>Action</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {items.map((item) => (\r\n              <tr key={item._id}>\r\n                <td>\r\n                  <img\r\n                    src={item.pic || defaultphoto}\r\n                    alt=\"Profile\"\r\n                    className=\"rounded-circle\"\r\n                    width=\"50\"\r\n                    height=\"50\"\r\n                  />\r\n                </td>\r\n                <td>{item.email}</td>\r\n                <td>{item.user?.name || \"No Name\"}</td> {/* Use optional chaining here */}\r\n                <td>\r\n                  <button\r\n                    className=\"btn btn-danger btn-sm\"\r\n                    onClick={() => handleDelete(item._id)}\r\n                  >\r\n                    Delete\r\n                  </button>\r\n                </td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      <div className=\"text-center mt-4\">\r\n        <button onClick={handleLogout} className=\"btn btn-success mx-2\">\r\n          Add User\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Enquiries;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}