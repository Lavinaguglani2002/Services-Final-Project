{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import\"./BlogsForm.css\";import axios from\"axios\";import{Link,useNavigate,useParams}from\"react-router-dom\";import api from\"../axios\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Updateblog=()=>{const navigate=useNavigate();const[items,setItems]=useState({});const[title,setTitle]=useState(\"\");const[photo,setPhoto]=useState(\"\");const[photourl,setPhotourl]=useState(\"\");const[content,setContent]=useState(\"\");const{id}=useParams();useEffect(()=>{if(id){fetchData();}},[id]);const fetchData=async()=>{try{const response=await api.post(`/viewblog/${id}`);console.log(\"Blogs Data:\",response.data);setItems(response.data);}catch(error){console.error(\"Error fetching data:\",error);}};//   useEffect(() => {\n//     if (items.length>0) {\n//       setTitle(items[0].title);\n//       setContent(items[0].content);\n//       setPhotourl(items[0].photo);\n//     }\n//   }, [items]);\nuseEffect(()=>{if(items&&Object.keys(items).length>0){setTitle(items.title);setContent(items.content);setPhotourl(items.photo);}},[items]);useEffect(()=>{if(photo){Upload(photo);}},[photo]);const Upload=photo=>{if(!photo){alert(\"Please select a photo\");return;}const data=new FormData();data.append(\"file\",photo);data.append(\"upload_preset\",\"bloggs\");data.append(\"cloud_name\",\"dnrels1zh\");fetch(\"https://api.cloudinary.com/v1_1/dnrels1zh/image/upload\",{method:\"POST\",body:data}).then(res=>res.json()).then(data=>{if(data.url){setPhotourl(data.url);localStorage.setItem(\"photo\",data.url);alert(\"Photo uploaded successfully\");}else{alert(\"Failed to upload photo\");}}).catch(err=>{console.error(\"Upload error:\",err);alert(\"Error uploading photo\");});};const handleSubmit=async e=>{e.preventDefault();if(!title||!content||!photourl){alert(\"All fields are required\");return;}alert(\"Submitting Blog...\");try{const formData={id,title,photo:photourl,content};const response=await api.post(\"/updateblog\",formData,{headers:{\"Content-Type\":\"application/json\"}});if(response.status===200){alert(\"Blog updated successfully\");navigate(\"/dashboard/getblogs\");setTitle(\"\");setPhoto(\"\");setContent(\"\");}}catch(error){console.error(\"Error submitting blog:\",error);alert(\"Failed to submit blog\");}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary mb-3\",children:/*#__PURE__*/_jsx(Link,{to:\"/dashboard/getblogs\",className:\"text-white text-decoration-none\",children:\"View Blogs\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"blog-container container mt-4 mb-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row justify-content-center m-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-md-8 col-lg-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card px-4 py-3 shadow-sm\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-center mb-3\",children:\"Update Blog Post\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Blog Title\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",placeholder:\"Enter blog title\",value:title,onChange:e=>setTitle(e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Image \"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",className:\"form-control\",onChange:e=>setPhoto(e.target.files[0])})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Blog Content\"}),/*#__PURE__*/_jsx(\"textarea\",{className:\"form-control\",rows:\"5\",placeholder:\"Write your blog...\",value:content,onChange:e=>setContent(e.target.value),required:true})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary w-100\",children:\"Update Blog\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6 mt-3 d-flex flex-column align-items-center\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"https://elearningindustry.com/wp-content/uploads/2013/09/how-to-use-blogs-in-the-classroom.jpg\",alt:\"Blog\",className:\"blog-image img-fluid rounded shadow\"}),/*#__PURE__*/_jsx(\"img\",{src:\"https://img.freepik.com/free-photo/online-message-blog-chat-communication-envelop-graphic-icon-concept_53876-139717.jpg\",alt:\"Blog\",className:\"blog-image img-fluid rounded shadow mt-4 d-none d-md-block\"})]})]})})]});};export default Updateblog;","map":{"version":3,"names":["React","useEffect","useState","axios","Link","useNavigate","useParams","api","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Updateblog","navigate","items","setItems","title","setTitle","photo","setPhoto","photourl","setPhotourl","content","setContent","id","fetchData","response","post","console","log","data","error","Object","keys","length","Upload","alert","FormData","append","fetch","method","body","then","res","json","url","localStorage","setItem","catch","err","handleSubmit","e","preventDefault","formData","headers","status","children","className","to","onSubmit","type","placeholder","value","onChange","target","required","files","rows","src","alt"],"sources":["C:/Users/Allied/Desktop/Serviceproject/client/src/Admin/Updateblog.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport \"./BlogsForm.css\";\r\nimport axios from \"axios\";\r\nimport { Link, useNavigate, useParams } from \"react-router-dom\";\r\nimport api from \"../axios\";\r\n\r\nconst Updateblog = () => {\r\n    const navigate=useNavigate()\r\n  const [items, setItems] = useState({});\r\n  const [title, setTitle] = useState(\"\");\r\n  const [photo, setPhoto] = useState(\"\");\r\n  const [photourl, setPhotourl] = useState(\"\");\r\n  const [content, setContent] = useState(\"\");\r\n  const { id } = useParams();\r\n\r\n  useEffect(() => {\r\n    if (id) {\r\n      fetchData();\r\n    }\r\n  }, [id]);\r\n\r\n  const fetchData = async () => {\r\n    try {\r\n      const response = await api.post(`/viewblog/${id}`);\r\n\r\n      console.log(\"Blogs Data:\", response.data);\r\n      setItems(response.data);\r\n    } catch (error) {\r\n      console.error(\"Error fetching data:\", error);\r\n    }\r\n  };\r\n\r\n//   useEffect(() => {\r\n//     if (items.length>0) {\r\n//       setTitle(items[0].title);\r\n//       setContent(items[0].content);\r\n//       setPhotourl(items[0].photo);\r\n//     }\r\n//   }, [items]);\r\n\r\nuseEffect(() => {\r\n    if (items && Object.keys(items).length > 0) {\r\n      setTitle(items.title);\r\n      setContent(items.content);\r\n      setPhotourl(items.photo);\r\n    }\r\n  }, [items]);\r\n  \r\n\r\n  useEffect(() => {\r\n    if (photo) {\r\n      Upload(photo);\r\n    }\r\n  }, [photo]);\r\n\r\n  const Upload = (photo) => {\r\n    if (!photo) {\r\n      alert(\"Please select a photo\");\r\n      return;\r\n    }\r\n\r\n    const data = new FormData();\r\n    data.append(\"file\", photo);\r\n    data.append(\"upload_preset\", \"bloggs\");\r\n    data.append(\"cloud_name\", \"dnrels1zh\");\r\n\r\n    fetch(\"https://api.cloudinary.com/v1_1/dnrels1zh/image/upload\", {\r\n      method: \"POST\",\r\n      body: data,\r\n    })\r\n      .then((res) => res.json())\r\n      .then((data) => {\r\n        if (data.url) {\r\n          setPhotourl(data.url);\r\n          localStorage.setItem(\"photo\", data.url);\r\n          alert(\"Photo uploaded successfully\");\r\n        } else {\r\n          alert(\"Failed to upload photo\");\r\n        }\r\n      })\r\n      .catch((err) => {\r\n        console.error(\"Upload error:\", err);\r\n        alert(\"Error uploading photo\");\r\n      });\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n\r\n    if (!title || !content || !photourl) {\r\n      alert(\"All fields are required\");\r\n      return;\r\n    }\r\n\r\n    alert(\"Submitting Blog...\");\r\n\r\n    try {\r\n      const formData = { id, title, photo: photourl, content };\r\n\r\n      const response = await api.post(\"/updateblog\", formData, {\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n      });\r\n\r\n      if (response.status === 200) {\r\n        alert(\"Blog updated successfully\");\r\n        navigate(\"/dashboard/getblogs\")\r\n\r\n        setTitle(\"\");\r\n        setPhoto(\"\");\r\n        setContent(\"\");\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error submitting blog:\", error);\r\n      alert(\"Failed to submit blog\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <button className=\"btn btn-secondary mb-3\">\r\n        <Link to=\"/dashboard/getblogs\" className=\"text-white text-decoration-none\">View Blogs</Link>\r\n      </button>\r\n      \r\n      <div className=\"blog-container container mt-4 mb-4\">\r\n        <div className=\"row justify-content-center m-4\">\r\n          \r\n          <div className=\"col-md-8 col-lg-6\">\r\n            <div className=\"card px-4 py-3 shadow-sm\">\r\n              <h2 className=\"text-center mb-3\">Update Blog Post</h2>\r\n              <form onSubmit={handleSubmit}>\r\n                <div className=\"mb-3\">\r\n                  <label className=\"form-label\">Blog Title</label>\r\n                  <input\r\n                    type=\"text\"\r\n                    className=\"form-control\"\r\n                    placeholder=\"Enter blog title\"\r\n                    value={title}\r\n                    onChange={(e) => setTitle(e.target.value)}\r\n                    required\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"mb-3\">\r\n                  <label className=\"form-label\">Image </label>\r\n                  <input\r\n                    type=\"file\"\r\n                    className=\"form-control\"\r\n                    onChange={(e) => setPhoto(e.target.files[0])}\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"mb-3\">\r\n                  <label className=\"form-label\">Blog Content</label>\r\n                  <textarea\r\n                    className=\"form-control\"\r\n                    rows=\"5\"\r\n                    placeholder=\"Write your blog...\"\r\n                    value={content}\r\n                    onChange={(e) => setContent(e.target.value)}\r\n                    required\r\n                  ></textarea>\r\n                </div>\r\n\r\n                <button type=\"submit\" className=\"btn btn-primary w-100\">\r\n                  Update Blog\r\n                </button>\r\n              </form>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"col-md-6 mt-3 d-flex flex-column align-items-center\">\r\n            <img\r\n              src=\"https://elearningindustry.com/wp-content/uploads/2013/09/how-to-use-blogs-in-the-classroom.jpg\"\r\n              alt=\"Blog\"\r\n              className=\"blog-image img-fluid rounded shadow\"\r\n            />\r\n            <img\r\n              src=\"https://img.freepik.com/free-photo/online-message-blog-chat-communication-envelop-graphic-icon-concept_53876-139717.jpg\"\r\n              alt=\"Blog\"\r\n              className=\"blog-image img-fluid rounded shadow mt-4 d-none d-md-block\"\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Updateblog;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}